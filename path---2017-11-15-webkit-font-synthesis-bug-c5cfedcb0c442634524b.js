webpackJsonp([0xd9e6f5255f53],{508:function(A,a){A.exports={data:{site:{siteMetadata:{title:"长天之云",author:"ambar"}},markdownRemark:{id:"/Users/lj/dev/ambar.github.com/src/posts/2017-11-15---webkit-font-synthesis-bug.md absPath of file >>> MarkdownRemark",html:'<p>如何重现：<a href="https://link.zhihu.com/?target=https%3A//codepen.io/ambarli/full/XzgYeP/">Code Pen 样例页面</a>（使用最新版 iOS/macOS Safari 访问）</p>\n<p>解决方式：</p>\n<div class="gatsby-highlight">\n      <pre class="language-css"><code class="language-css"><span class="token property">font-synthesis</span><span class="token punctuation">:</span> style<span class="token punctuation">;</span>\n</code></pre>\n      </div>\n<p>样例截图：</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/2017-11-15---bug-d33cf2295493a9e1a330c7779811949e-240ae.jpg"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 113.47222222222221%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAXABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIDBAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHs3UyLURjmGgH/xAAcEAABAwUAAAAAAAAAAAAAAAABAhARAxIiMTL/2gAIAQEAAQUCDjZVDW51BKk8/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAWEAEBAQAAAAAAAAAAAAAAAAAQEUH/2gAIAQEABj8CY6//xAAcEAADAAEFAAAAAAAAAAAAAAAAARExECFRYXH/2gAIAQEAAT8h8XsWNGWw2URwTb4FFCY1TEf/2gAMAwEAAgADAAAAEJAHAP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EAB8QAAICAgEFAAAAAAAAAAAAAAERADEhQVEQYXGh4f/aAAgBAQABPxAwy79jj1FRBDhLoFuFP5DCAx8wE0hrMIShtscwlAAUu8BDLwNz/9k=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="样例"\n        title=""\n        src="/static/2017-11-15---bug-d33cf2295493a9e1a330c7779811949e-b80fa.jpg"\n        srcset="/static/2017-11-15---bug-d33cf2295493a9e1a330c7779811949e-cf410.jpg 163w,\n/static/2017-11-15---bug-d33cf2295493a9e1a330c7779811949e-62f2a.jpg 325w,\n/static/2017-11-15---bug-d33cf2295493a9e1a330c7779811949e-b80fa.jpg 650w,\n/static/2017-11-15---bug-d33cf2295493a9e1a330c7779811949e-240ae.jpg 720w"\n        sizes="(max-width: 650px) 100vw, 650px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>macOS High Sierra 10.13.1 - Safari</p>\n<p>说明：</p>\n<ul>\n<li>重现版本为 iOS 11.1.1，macOS High Sierra 10.13.1，条件为使用 <code>-apple-system</code> 指定字体（即同时使用苹方与 San Francisco）</li>\n<li>红色的方框内被加粗的<strong>中文</strong>是「伪粗体」，在字重为 <strong>600/700</strong> 时触发</li>\n<li>绿色的方框内是应用样式修复后的结果</li>\n<li><code>font-synthesis: initial</code>相当于 <code>font-synthesis: weight style</code>，因此不能使用 <code>font-synthesis: none</code> ，否则会影响斜体（font-style）的合成</li>\n<li>高 DPI 设备（iPhone X）问题不太明显</li>\n<li>WebKit 一个月前修复了这个问题（<a href="https://link.zhihu.com/?target=https%3A//trac.webkit.org/changeset/223589/webkit">r223589</a>，此文的修复方法就是参考了它的回归测试代码），<del>但什么时候能发布不确定</del> 己在 Safari Technology Preview 11.1（WebKit 13605.1.13.2）中确认被修复</li>\n</ul>\n<hr>\n<p>关于字体样式的补充：</p>\n<ul>\n<li>为了与原生界面的字体一致，web 页面会按「system-ui, fallback names, generic name」顺序指定字体，如：<code>font-family: -apple-system, BlinkMacSystemFont, ..., sans-serif</code></li>\n<li>根据截图也可以看出，苹方没有 Bold 字重（只有 Semibold，600），而 San Francisco 有 Bold 字重，会导致 CSS 使用 bold（700）指定字重时，中西文粗体不均衡（中文回退到 600），使用 500 或 600 会达到最佳效果</li>\n<li>Android 中文使用思源黑体，但由于字重缺失，需要使用 700 达到加粗效果；西文有点值得注意，lang 属性会影响字体选择（<a href="https://link.zhihu.com/?target=https%3A//codepen.io/ambarli/pen/XzaEPr">CodePen demo: lang &#x26; Noto Sans &#x26; Roboto</a>），zh 会应用思源黑体，en 会应用 Roboto</li>\n</ul>\n<p>根据上述限制，推荐在项目中使用 mixin 实现粗体：</p>\n<div class="gatsby-highlight">\n      <pre class="language-css"><code class="language-css"><span class="token comment">/* postcss-mixins 的例子 */</span>\n<span class="token atrule"><span class="token rule">@define-mixin</span> bold</span> <span class="token punctuation">{</span>\n  <span class="token comment">/* 也可以只应用在 iOS/macOS 上 */</span>\n  <span class="token property">font-weight</span><span class="token punctuation">:</span> 600<span class="token punctuation">;</span>\n  <span class="token property">font-synthesis</span><span class="token punctuation">:</span> style<span class="token selector">;\n\n  html[data-android] &amp;</span> <span class="token punctuation">{</span>\n    <span class="token property">font-weight</span><span class="token punctuation">:</span> 700<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">.title</span> <span class="token punctuation">{</span>\n  <span class="token atrule"><span class="token rule">@mixin</span> bold<span class="token punctuation">;</span></span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<hr>\n<p>当中英文同时出现而字重不一的例子，来自 iOS 官方应用：</p>\n<p>音乐: \n  <a\n    class="gatsby-resp-image-link"\n    href="/static/2017-11-15---02-47c33cceb076d1a6521945c1a0f1b7fb-240ae.jpg"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAMCAQX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAH3EdlGR2YXB//EABkQAAMBAQEAAAAAAAAAAAAAAAABEQISMf/aAAgBAQABBQKkREdV06NeZ1Wf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAGhAAAgIDAAAAAAAAAAAAAAAAADEBAiAhQf/aAAgBAQAGPwJSIROrHcf/xAAeEAEAAgIBBQAAAAAAAAAAAAABABEhMWEQQVFxsf/aAAgBAQABPyGgvwizaGHAhqjtPKvW4cGYNrWY9aHT/9oADAMBAAIAAwAAABBk6Dz/xAAVEQEBAAAAAAAAAAAAAAAAAAABIP/aAAgBAwEBPxBj/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAHBABAQADAQADAAAAAAAAAAAAAREAIUFRMWGB/9oACAEBAAE/EAkK3e0xso+zINQOSYSdB1sGdMCSyem/zKXVGb7hDQqm+4fmNdHcCfHc/9k=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="音乐"\n        title=""\n        src="/static/2017-11-15---02-47c33cceb076d1a6521945c1a0f1b7fb-b80fa.jpg"\n        srcset="/static/2017-11-15---02-47c33cceb076d1a6521945c1a0f1b7fb-cf410.jpg 163w,\n/static/2017-11-15---02-47c33cceb076d1a6521945c1a0f1b7fb-62f2a.jpg 325w,\n/static/2017-11-15---02-47c33cceb076d1a6521945c1a0f1b7fb-b80fa.jpg 650w,\n/static/2017-11-15---02-47c33cceb076d1a6521945c1a0f1b7fb-240ae.jpg 720w"\n        sizes="(max-width: 650px) 100vw, 650px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>App Store: \n  <a\n    class="gatsby-resp-image-link"\n    href="/static/2017-11-15---03-77b8f0bad92857bcbcafdfafdbb1c6b2-240ae.jpg"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAMCBf/EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAAB6ls0jAutzGbA/8QAGxABAAICAwAAAAAAAAAAAAAAAQACAxESITL/2gAIAQEAAQUCMhe4E5VrD0MRY9FXbP/EABYRAQEBAAAAAAAAAAAAAAAAAAEAEP/aAAgBAwEBPwGA3//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EAB4QAAECBwEAAAAAAAAAAAAAAAECEAAgITFBQmGR/9oACAEBAAY/AlJGvIsPGOGoRJ//xAAeEAEAAgEEAwAAAAAAAAAAAAABABEhEDFBcVGBkf/aAAgBAQABPyE9htTcNOaHAaOiYbOW4Tgu/UfH4pkJ3MIh50//2gAMAwEAAgADAAAAEJ/QAP/EABkRAQACAwAAAAAAAAAAAAAAAAEAERCR8P/aAAgBAwEBPxBKii17Wf/EABgRAAIDAAAAAAAAAAAAAAAAAAERABAh/9oACAECAQE/EAXsLv8A/8QAHxABAQACAQQDAAAAAAAAAAAAAREAITFBUWGhgZHw/9oACAEBAAE/EFJ1FpbNPXNv+pPZkM0SnD+1lRye4r51lord1GBAEjau8kUU9sSIC8DrgT5z/9k=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="App Store"\n        title=""\n        src="/static/2017-11-15---03-77b8f0bad92857bcbcafdfafdbb1c6b2-b80fa.jpg"\n        srcset="/static/2017-11-15---03-77b8f0bad92857bcbcafdfafdbb1c6b2-cf410.jpg 163w,\n/static/2017-11-15---03-77b8f0bad92857bcbcafdfafdbb1c6b2-62f2a.jpg 325w,\n/static/2017-11-15---03-77b8f0bad92857bcbcafdfafdbb1c6b2-b80fa.jpg 650w,\n/static/2017-11-15---03-77b8f0bad92857bcbcafdfafdbb1c6b2-240ae.jpg 720w"\n        sizes="(max-width: 650px) 100vw, 650px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>',frontmatter:{title:"用 CSS 修复 WebKit 伪粗体问题",date:"2017-11-15 16:08"}}},pathContext:{slug:"/2017-11-15---webkit-font-synthesis-bug/",previous:{fields:{slug:"/2017-11-04---align-svg-icon-to-text/"},frontmatter:{title:"图标如何对齐文本"}},next:{fields:{slug:"/2018-02-05---css-dark-mode/"},frontmatter:{title:"CSS 实现夜间模式"}}}}}});